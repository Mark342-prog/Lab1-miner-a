---
title: "ParteAndrés"
output: html_document
---
#Parte 1

Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos.
```{r Parte1}
knitr::opts_chunk$set(echo = TRUE)
if(!require('stats')) {
  install.packages('stats')
  library('stats')
  
movies <- read.csv("movies_2026.csv")

summary(movies)

library(ggplot2)
library(dplyr)
library(tidyr)


movies <- movies %>%
  mutate(genres = gsub(" \\| ", "|", genres))
movies_long <- movies %>%
  separate_rows(genres, sep = "\\|")
movies_longs <- movies_long %>%
  separate_rows(genres, sep = "\\s*\\|\\s*")
movies_longss <- movies_longs %>%
  filter(budget != "0")

top10_genres <- movies_longss %>%
  group_by(genres) %>%
  summarise(
    presupuesto_promedio = mean(budget, na.rm = TRUE),
    n = n()
  ) %>%
  arrange(desc(presupuesto_promedio)) %>%
  slice_head(n = 10)

top10_genres

ggplot(top10_genres,aes(x = reorder(genres, presupuesto_promedio),y = presupuesto_promedio)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Top 10 géneros con mayor presupuesto promedio",
    x = "Género",
    y = "Presupuesto promedio"
  )


```